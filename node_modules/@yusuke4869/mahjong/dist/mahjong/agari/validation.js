"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.inputValidation = exports.furoValidation = void 0;
const array_1 = require("../hai/array");
const convert_1 = require("../hai/convert");
const sort_1 = require("../hai/sort");
const furoValidation = (furo) => {
    const haiType = (0, convert_1.getHaiSuffix)(furo.hai[0]);
    for (const h of furo.hai) {
        const hType = (0, convert_1.getHaiSuffix)(h);
        if (hType !== haiType)
            return false;
    }
    if (furo.type === "chi") {
        if (furo.hai.length !== 3)
            return false;
        const haiType = (0, convert_1.getHaiSuffix)(furo.hai[0]);
        if (haiType === "z")
            return false;
        const hai = (0, sort_1.sortHai)(furo.hai);
        const num = (0, convert_1.getHaiNormalNum)(hai[0]);
        if (num > 7)
            return false;
        for (let i = 1; i < 3; i++) {
            const n = (0, convert_1.getHaiNormalNum)(hai[i]);
            if (n - num !== i)
                return false;
        }
        return true;
    }
    if (furo.type === "pon" || furo.type === "daiminkan" || furo.type === "ankan" || furo.type === "kakan") {
        if (furo.type === "pon") {
            if (furo.hai.length !== 3)
                return false;
        }
        else {
            if (furo.hai.length !== 4)
                return false;
        }
        const num = (0, convert_1.getHaiNormalNum)(furo.hai[0]);
        for (const h of furo.hai) {
            const n = (0, convert_1.getHaiNormalNum)(h);
            if (n !== num)
                return false;
        }
        return true;
    }
    return false;
};
exports.furoValidation = furoValidation;
const inputValidation = (input) => {
    const hai = Array.from(input.hai);
    for (const furo of input.furo) {
        const r = (0, exports.furoValidation)(furo);
        if (!r)
            return false;
        hai.push(...furo.hai);
    }
    if (hai.length < 14)
        return false;
    if (input.hai.length !== 14 - input.furo.length * 3)
        return false;
    const haiArrObj = (0, array_1.getHaiArrayObject)(hai);
    for (const k of Object.keys(haiArrObj)) {
        for (const v of haiArrObj[k]) {
            if (v > 4)
                return false;
        }
    }
    return true;
};
exports.inputValidation = inputValidation;
//# sourceMappingURL=validation.js.map